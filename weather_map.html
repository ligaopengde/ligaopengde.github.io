<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>中国地图</title>
    <link rel="stylesheet" href="rili.css">
    <script src="rili.js" type="module"></script>
    <script src="./jquery.min.js"></script>
    <script src="./echarts.min.js"></script>
    <script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
    <style>
        #main {
            float: left;
        }
        .container {
            float: right;
        }
    </style>
</head>

<body>
    <div id="main" style="width: 1300px; height: 930px"></div>
    <div class="container">
        <header class="today">
            <div class="day">9</div>
            <div class="month">October</div>
        </header>
        <main class="calendar">
            <div class="days">
                <span>Sun</span>
                <span>Mon</span>
                <span>Tue</span>
                <span>Wed</span>
                <span>Thu</span>
                <span>Fri</span>
                <span>Sat</span>
            </div>
            <div class="dates">
                <span class="previous-month">27</span>
                <span class="previous-month">28</span>
                <span class="previous-month">29</span>
                <span class="previous-month">30</span>
                <span>1</span>
                <span>2</span>
                <span>3</span>
                <span>4</span>
                <span>5</span>
                <span>6</span>
                <span>7</span>
                <span>8</span>
                <span class="current-day">9</span>
                <span>10</span>
                <span>11</span>
                <span>12</span>
                <span>13</span>
                <span>14</span>
                <span>15</span>
                <span>16</span>
                <span>17</span>
                <span>18</span>
                <span>19</span>
                <span>20</span>
                <span>21</span>
                <span>22</span>
                <span>23</span>
                <span>24</span>
                <span>25</span>
                <span>26</span>
                <span>27</span>
                <span>28</span>
                <span>29</span>
                <span>30</span>
                <span>31</span>
                <span class="next-month">1</span>
                <span class="next-month">2</span>
                <span class="next-month">3</span>
                <span class="next-month">4</span>
                <span class="next-month">5</span>
                <span class="next-month">6</span>
                <span class="next-month">7</span>
            </div>
        </main>
    </div>
    <script >
        const provinces_name2code = {
            '北京市': '110000', '天津市': '120000', '河北省': '130000', '山西省': '140000',
            '内蒙古自治区': '150000', '辽宁省': '210000', '吉林省': '220000', '黑龙江省': '230000', '上海市': '310000',
            '江苏省': '320000', '广东省': '440000', '新疆维吾尔自治区': '650000', '浙江省': '330000', '安徽省': '340000',
            '福建省': '350000', '江西省': '360000', '山东省': '370000', '河南省': '410000', '湖北省': '420000',
            '湖南省': '430000', '广西壮族自治区': '450000', '海南省': '460000', '重庆市': '500000', '四川省': '510000',
            '贵州省': '520000', '云南省': '530000', '西藏自治区': '540000', '陕西省': '610000', '甘肃省': '620000', '青海省': '630000',
            '宁夏回族自治区': '640000', '台湾省': '710000', '香港特别行政区': '810000', '澳门特别行政区': '820000', '台湾省': '710000'
        };

        // 假设主题名称是 "vintage"
        var myChart = echarts.init(document.getElementById("main"), "vintage");
        // // 初始化全国地图
        loadMap("./china.json", "china");
        function loadMap(mapCode, name) {
            $.get("./china.json", function (data) {
                //使用 HTTP GET 请求从服务器加载数据
                echarts.registerMap(name, data); //注册可用地图
                var option = {
                    title: {
                        text: "Weather Maps",
                        left: 20,
                        top: 20,
                    },
                    geo: {
                        type: "map",
                        map: name,
                        itemStyle: {
                            // areaColor: "#2E72BF",
                            boardColar: "#333"
                        }
                    },
                    series: [
                        {
                            name: "weather maps",
                            // data: provincesdata,
                            geoIndex: 0,
                            type: "scatter",
                            coordinateSystem: 'geo',
                            data: [
                                { value: ['116.40', '39.90', '扬沙', '11 ~ 24', '2024-04-15'] },
                                { value: ['117.19', '39.12', '晴', '13 ~ 23', '2024-04-15'] },
                                { value: ['114.50', '38.04', '晴', '10 ~ 23', '2024-04-15'] },
                                { value: ['112.54', '37.85', '晴', '5 ~ 23', '2024-04-15'] },
                                { value: ['111.67', '40.81', '晴', '4 ~ 16', '2024-04-15'] },
                                { value: ['123.42', '41.79', '小雨', '7 ~ 18', '2024-04-15'] },
                                { value: ['125.32', '43.88', '小雨', '6 ~ 16', '2024-04-15'] },
                                { value: ['126.64', '45.75', '小雨', '7 ~ 21', '2024-04-15'] },
                                { value: ['121.47', '31.23', '多云', '16 ~ 27', '2024-04-15'] },
                                { value: ['118.76', '32.04', '多云', '18 ~ 25', '2024-04-15'] },
                                { value: ['120.15', '30.28', '多云', '17 ~ 28', '2024-04-15'] },
                                { value: ['117.28', '31.86', '阴', '18 ~ 26', '2024-04-15'] },
                                { value: ['119.30', '26.07', '多云', '21 ~ 32', '2024-04-15'] },
                                { value: ['115.89', '28.67', '多云', '22 ~ 31', '2024-04-15'] },
                                { value: ['117.00', '36.67', '小雨', '13 ~ 25', '2024-04-15'] },
                                { value: ['113.66', '34.75', '多云', '14 ~ 26', '2024-04-15'] },
                                { value: ['114.29', '30.58', '多云', '20 ~ 29', '2024-04-15'] },
                                { value: ['112.98', '28.19', '小雨', '21 ~ 31', '2024-04-15'] },
                                { value: ['113.28', '23.12', '多云', '23 ~ 31', '2024-04-15'] },
                                { value: ['108.32', '22.82', '多云', '23 ~ 32', '2024-04-15'] },
                                { value: ['110.33', '20.03', '多云', '24 ~ 36', '2024-04-15'] },
                                { value: ['106.50', '29.53', '阴', '20 ~ 32', '2024-04-15'] },
                                { value: ['104.06', '30.65', '阴', '19 ~ 29', '2024-04-15'] },
                                { value: ['106.71', '26.57', '多云', '18 ~ 30', '2024-04-15'] },
                                { value: ['102.71', '25.04', '晴', '14 ~ 28', '2024-04-15'] },
                                { value: ['91.13', '29.66', '多云', '5 ~ 17', '2024-04-15'] },
                                { value: ['108.94', '34.26', '多云', '13 ~ 25', '2024-04-15'] },
                                { value: ['103.82', '36.05', '浮尘', '10 ~ 24', '2024-04-15'] },
                                { value: ['101.77', '36.62', '多云', '5 ~ 20', '2024-04-15'] },
                                { value: ['106.27', '38.46', '多云', '6 ~ 20', '2024-04-15'] },
                                { value: ['87.61', '43.79', '晴', '9 ~ 20', '2024-04-15'] },
                                { value: ['121.50', '25.04', '少云', '24 ~ 33', '2024-04-15'] },
                                { value: ['114.17', '22.32', '晴', '25 ~ 32', '2024-04-15'] },
                                { value: ['113.54', '22.19', '多云', '24 ~ 30', '2024-04-15'] }
                            ],
                            symbol: function (params) {
                                console.log('---> params', params[2])
                                if (params[2] == '多云') {
                                    return 'image://http://127.0.0.1:5500/weather_map/img/dy.png';
                                } else if (params[2] == '晴') {
                                    return 'image://http://127.0.0.1:5500/weather_map/img/qing.png';
                                } else if (params[2] == '小雨') {
                                    return 'image://http://127.0.0.1:5500/weather_map/img/xy.png'
                                } else {
                                    return 'image://http://127.0.0.1:5500/weather_map/img/lzy.png'
                                }
                            },
                            // symbol: 'image://http://127.0.0.1:5500/weather_map/img/lzy.png',
                            symbolSize: 30
                        }
                    ],
                };

                // 使用刚指定的配置项和数据显示图表。
                myChart.setOption(option);

                myChart.on('click', function (params) {
                    console.log(params['name']);
                    $.get("https://geo.datav.aliyun.com/areas_v3/bound/" + String(provinces_name2code[params['name']]) + "_full.json", function (res) {
                        //使用 HTTP GET 请求从服务器加载数据
                        echarts.registerMap(params['name'], res, 'vintage'); //注册可用地图
                        var option = {
                            geo: {
                                type: "map",
                                map: params['name'],
                            },
                        };
                        // 使用刚指定的配置项和数据显示图表。
                        myChart.setOption(option);
                    });
                });
            });
        };

        //鼠标双击事件函数
        main.ondblclick = function (params) {
            loadMap("./china.json", "china");
        };
    </script>
</body>

</html>